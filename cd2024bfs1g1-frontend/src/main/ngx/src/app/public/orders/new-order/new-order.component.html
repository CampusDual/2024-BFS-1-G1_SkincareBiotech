<div class="order-container">
    <ng-container *ngIf="cart.length; else showMessage">
 
        <div class="cart-item-container">
            <div *ngFor="let item of cart">
                <app-cart-item [item]="item" (updateCart)="updateTotalAmount()" ></app-cart-item>
            </div>
            <div class="total-amount">Total: {{totalAmount | number: '1.2-2' }}€</div>
        </div>
        <o-form class="order-form" #formOrder attr="newOrder" service="profiles" entity="userProfile" keys="USR_ID"
        columns="USR_ID;USR_NAME;USR_SURNAME;USR_PHONE;UPR_ADDRESS;UPR_ZIPCODE"
            visible-columns="USR_NAME;USR_SURNAME;USR_PHONE;UPR_ADDRESS;UPR_ZIPCODE" header-actions="U"
            show-header-navigation="no" show-header="false" (onDataLoaded)="onFormDataLoaded($event)">
            <div fxLayout="row">
                <o-column class="order-column" fxFlex title="ORDER_INFORMATION">
                    <div fxLayout="column" fxLayoutGap="12px" class="order-inputs">
                        <o-integer-input #usrId attr="USR_ID" hidden sql-type="INTEGER" enabled="no" ></o-integer-input>
                        <o-text-input #nameInput class="order-input" attr="USR_NAME" required="yes"
                            placeholder="USR_NAME"></o-text-input>
                        <o-integer-input #phoneInput class="order-input" attr="USR_PHONE"
                            thousand-separator=" " required="yes" placeholder="USR_PHONE">     
                        </o-integer-input>
                        <o-text-input #zipInput class="order-input" attr="UPR_ZIPCODE" min="0"
                            max="99999" thousand-separator="" required="yes"
                            placeholder="UPR_ZIPCODE">
                            <o-validator error-name="pattern" error-text="Only alphanumeric characters and underscores are allowed"></o-validator>
                            <o-validator error-name="minlength" error-text="Minimum length is 5 characters"></o-validator>
                            <o-validator error-name="maxlength" error-text="Maximum length is 5 characters"></o-validator>          
                        </o-text-input>
                        <o-text-input #addressInput class="order-input" attr="UPR_ADDRESS" required="yes"
                            placeholder="UPR_ADDRESS"></o-text-input>
                        
                            <mat-checkbox #defAddress boolean-type="boolean">{{"SET_DEFAULT" | oTranslate}}</mat-checkbox>
             
                            <!--<o-button (onClick)="submitOrder()" type="RAISED" label="CASH_ON_DELIVERY" class="order-button"></o-button>-->
                            <button mat-raised-button id="back-button"(click)="submitOrder()" type="RAISED" label="Comprar:Redsys">{{'PURCHASE_BUTTON' | oTranslate}}</button>  
 
                    </div>
                </o-column>
            </div>
        </o-form>
    </ng-container>
    <ng-template  #showMessage>
        <div class="no-cart">
            <div class="mensaje">
                El carrito está vacío
                <img style="height: 5px;" src="https://ih1.redbubble.net/image.5076899693.9202/flat,750x,075,f-pad,750x1000,f8f8f8.u1.jpg"/>
              </div>
              <button mat-raised-button id="back-button" attr="BACK_BUTTON" (click)="goBack()">{{'BACK_BUTTON' | oTranslate}}</button>        
        </div>
      </ng-template>
</div>
 
<form name="form" action="https://sis-t.redsys.es:25443/sis/realizarPago" method="POST" (submit)="submitRedsysOrder()" ngNoForm>    
    <!-- Valor fijo -->
    <input  type="hidden" name="Ds_SignatureVersion" value="HMAC_SHA256_V1"/>
    <!-- Cadena en formato JSON con todos los datos de la petición (ver formulario del js) -->
    <!-- Tras montar la cadena, es necesario codificarla en BASE64 -->
    <input  type="hidden" name="Ds_MerchantParameters" value="" id="Ds_MerchantParameters"#Ds_MerchantParameters/>
    <input  type="hidden" name="Ds_Signature" value="" id="Ds_Signature" #Ds_Signature/>
</form>